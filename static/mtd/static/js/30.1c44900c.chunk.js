(this["webpackJsonpmtd-app"]=this["webpackJsonpmtd-app"]||[]).push([[30,49],{288:function(e,t,a){"use strict";a.r(t);var n=a(212),r=a.n(n),o=a(211),i=a(213),u=a(200),c=a(9),s=a.n(c),l=a(219),d=a(210),p=a.n(d),m=a(817),v=a(84),f=a.n(v),b=a(221),h=a(205),g=a(236),y=a(240),S=a(237),C=a(207),O=a(208),j=a(331),w=a(330),E=a(359),k=a(444),T=a(17),x=a(199);function A(){var e=Object(x.a)(["\n  margin: 20px 0;\n  \n  div {\n    margin: auto;\n  }\n"]);return A=function(){return e},e}var D=a(198).default.div(A()),q=function(e){var t=e.onChange,a=e.setRecaptchaAvailable,n=Object(m.a)().i18n,r=s.a.useState(!0),o=Object(u.a)(r,2),i=o[0],c=o[1],l=s.a.useCallback((function(e){if(e&&e.captcha){var t=e.captcha;new MutationObserver((function(e,a){var n,r=Object(E.a)(e);try{for(r.s();!(n=r.n()).done;){"childList"===n.value.type&&t.childNodes[0].children.length>1&&(c(!1),a.disconnect())}}catch(o){r.e(o)}finally{r.f()}})).observe(t,{childList:!0,subtree:!0})}}),[]);return s.a.createElement(D,null,i&&s.a.createElement("div",{className:"text-center"},"Cargando, por favor espere..."),s.a.createElement(k.a,{ref:l,sitekey:"6LcRhdIZAAAAAOI8zafkWF0N5SYOUjMszuEUnrJT",onChange:t,onErrored:function(){a(!1),T.a("Error on ReCAPTCHA")},hl:n.language,size:"compact"}))},B=a(203),I=a(204),L=a(426),z=a.n(L).a.create({baseURL:"https://lwdzsrlhnk.execute-api.us-east-2.amazonaws.com/prod"});function M(e){return R.apply(this,arguments)}function R(){return(R=Object(i.a)(r.a.mark((function e(t){var a,n,o,i,u,c,s,l,d,p,m,v,f,b,h,g,y,S,C,O,j,w,E,k,T,x,A;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.setSubmitError,n=t.state,o=t.captchaValue,i=t.action,u=t.nextStep,c=t.setActiveStep,s=t.history,e.prev=1,a(null),p=n.welcome,m=p.patientId,v=p.agreedConsentTerms,f=p.agreedPolicyTerms,b=p.agreedCovidDetection,h=p.agreedCovidCollection,g=p.agreedTrainingArtificial,y=p.agreedBiometric,S=n["submit-steps"],C=S.recordYourCough,O=S.currentSymptoms,j=S.symptomsStartedDate,w=new FormData,m&&w.append("patientId",m),window.sourceCampaign&&w.append("source",window.sourceCampaign),w.append("agreedConsentTerms",v),w.append("agreedPolicyTerms",f),w.append("agreedCovidCollection",h),w.append("agreedCovidDetection",b),w.append("agreedTrainingArtificial",g),w.append("agreedBiometric",y),E=C.recordingFile||C.uploadedFile,w.append("cough",E,E.name||"filename.wav"),(null===O||void 0===O||null===(l=O.selected)||void 0===l?void 0:l.length)>0&&w.append("currentSymptoms",O.selected.join(",")),j&&w.append("symptomsStartedDate",j),(null===O||void 0===O?void 0:O.other)&&w.append("otherSymptoms",null===O||void 0===O?void 0:O.other),o&&w.append("captchaValue",o),e.next=22,z.post("saveMTDInfo",w,{headers:{"Content-Type":"multipart/form-data; boundary=saveMTDInfo"}});case 22:k=e.sent,i({}),u&&(null===(d=k.data)||void 0===d?void 0:d.submissionId)&&(c(!1),s.push(u,{predictionResult:null!==(T=null===(x=k.data)||void 0===x||null===(A=x.prediction)||void 0===A?void 0:A.result)&&void 0!==T?T:"unknown"})),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(1),console.log(e.t0),a("beforeSubmit:submitError");case 31:case"end":return e.stop()}}),e,null,[[1,27]])})))).apply(this,arguments)}function V(e){if(!(null===e||void 0===e?void 0:e.selected))return!1;for(var t=e.selected,a=["breathShortness","feverChillsSweating","dryCough","wetCough","newOrWorseCough"],n=!1,r=0;!n&&r<(null===t||void 0===t?void 0:t.length);r++)n=a.includes(t[r]);return n}var F=a(248),P=S.object({symptomsStartedDate:S.string().when("currentSymptoms",{is:function(e){return V(e)},then:function(e){return e.required()},otherwise:function(e){return e}})}).defined();t.default=s.a.memo((function(e){var t=e.previousStep,a=e.nextStep,n=e.storeKey,d=e.metadata,v=p()({bindTo:document&&document.getElementById("wizard-buttons")}).Portal,S=Object(B.a)(),E=S.setDoGoBack,k=S.setTitle,T=S.setType,x=Object(l.g)(),A=Object(m.a)().t,D=Object(h.d)(Object(C.b)(n)),L=D.state,z=D.action,R=s.a.useState(!0),W=Object(u.a)(R,2),J=W[0],N=W[1],U=Object(b.e)({mode:"onChange",defaultValues:null===L||void 0===L?void 0:L[n],resolver:Object(g.a)(P)}),H=U.control,Q=U.handleSubmit,Y=U.formState,G=U.watch,K=Y.errors,Z=Y.isValid,_=G("currentSymptoms"),X=s.a.useState(null),$=Object(u.a)(X,2),ee=$[0],te=$[1],ae=s.a.useState(null),ne=Object(u.a)(ae,2),re=ne[0],oe=ne[1],ie=s.a.useState(!0),ue=Object(u.a)(ie,2),ce=ue[0],se=ue[1],le=Y.isSubmitting;Object(c.useEffect)((function(){re||te(null)}),[re]);var de=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,M({setSubmitError:function(e){return te(e?A(e):null)},state:Object(o.a)(Object(o.a)({},L),{},{"submit-steps":Object(o.a)(Object(o.a)({},L["submit-steps"]),t)}),captchaValue:re,action:z,nextStep:a,setActiveStep:N,history:x});case 3:f.a.dataLayer({dataLayer:{event:"successful_session"}}),a&&(N(!1),x.push(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=s.a.useCallback((function(){N(!1),t?x.push(t):x.goBack()}),[x,t]);Object(c.useEffect)((function(){Object(I.a)(),k(A("questionary:headerQuestions")),T("primary"),E((function(){return pe}))}),[pe,E,k,T,A]);var me=s.a.useMemo((function(){return V(_)}),[_]);return s.a.createElement(F.MainContainer,null,s.a.createElement(j.a,{currentStep:null===d||void 0===d?void 0:d.current,totalSteps:null===d||void 0===d?void 0:d.total,progressBar:!0}),me&&s.a.createElement(s.a.Fragment,null,s.a.createElement(F.QuestionText,{extraSpace:!0,first:!0},A("questionary:symptomsDate")),s.a.createElement(b.a,{control:H,name:"symptomsStartedDate",defaultValue:"",render:function(e){var t=e.onChange,a=e.value;return s.a.createElement(w.a,{singleSelection:!0,value:{selected:a?[a]:[]},onChange:function(e){return t(e.selected[0])},items:[{value:"today",label:A("questionary:options.today")},{value:"days",label:A("questionary:options.days")},{value:"week",label:A("questionary:options.week")},{value:"overWeek",label:A("questionary:options.overWeek")}]})}})),s.a.createElement("p",null,s.a.createElement(y.a,{errors:K,name:"name"})),J&&s.a.createElement(v,null,s.a.createElement(q,{onChange:oe,setRecaptchaAvailable:se}),ee&&s.a.createElement(F.TempBeforeSubmitError,null,ee),s.a.createElement(O.a,{invert:!0,leftLabel:A("questionary:nextButton"),leftDisabled:le||ce&&!re||!Z,leftHandler:Q(de)})))}))},305:function(e,t,a){"use strict";a.r(t);var n=a(288);a.d(t,"default",(function(){return n.default}))}}]);
//# sourceMappingURL=30.1c44900c.chunk.js.map