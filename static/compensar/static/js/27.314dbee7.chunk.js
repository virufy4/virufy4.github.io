(this["webpackJsonpcompensar-app"]=this["webpackJsonpcompensar-app"]||[]).push([[27,45],{288:function(e,t,a){"use strict";a.r(t);var n=a(212),r=a.n(n),o=a(211),i=a(213),s=a(200),u=a(9),c=a.n(u),l=a(218),d=a(210),p=a.n(d),m=a(812),v=a(84),f=a.n(v),b=a(221),h=a(203),g=a(236),y=a(240),S=a(237),E=a(207),w=a(208),C=a(328),O=a(327),j=a(438),A=a(17),k=a(199);function x(){var e=Object(k.a)(["\n  margin: 20px 0;\n  \n  div {\n    margin: auto;\n  }\n"]);return x=function(){return e},e}var T=a(198).default.div(x()),I=function(e){var t=e.onChange,a=e.setRecaptchaAvailable,n=Object(m.a)().i18n;return c.a.createElement(T,null,c.a.createElement(j.a,{sitekey:"6LcRhdIZAAAAAOI8zafkWF0N5SYOUjMszuEUnrJT",onChange:t,onErrored:function(){a(!1),A.a("Error on ReCAPTCHA")},hl:n.language,size:"compact"}))},D=a(204),q=a(205),z=a(422),B=a.n(z).a.create({baseURL:"https://lwdzsrlhnk.execute-api.us-east-2.amazonaws.com/prod"});function L(e){return F.apply(this,arguments)}function F(){return(F=Object(i.a)(r.a.mark((function e(t){var a,n,o,i,s,u,c,l,d,p,m,v,f,b,h,g,y,S,E,w,C,O,j,A,k;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.setSubmitError,n=t.state,o=t.captchaValue,i=t.action,s=t.nextStep,u=t.setActiveStep,c=t.history,e.prev=1,a(null),p=n.welcome,m=p.patientId,v=p.agreedConsentTerms,f=p.agreedPolicyTerms,b=p.agreedCovidDetection,h=p.agreedCovidCollection,g=p.agreedTrainingArtificial,y=p.agreedBiometric,S=n["submit-steps"],E=S.recordYourCough,w=S.currentSymptoms,C=S.symptomsStartedDate,O=new FormData,m&&O.append("patientId",m),window.sourceCampaign&&O.append("source",window.sourceCampaign),O.append("agreedConsentTerms",v),O.append("agreedPolicyTerms",f),O.append("agreedCovidCollection",h),O.append("agreedCovidDetection",b),O.append("agreedTrainingArtificial",g),O.append("agreedBiometric",y),j=E.recordingFile||E.uploadedFile,O.append("cough",j,j.name||"filename.wav"),(null===w||void 0===w||null===(l=w.selected)||void 0===l?void 0:l.length)>0&&O.append("currentSymptoms",w.selected.join(",")),C&&O.append("symptomsStartedDate",C),(null===w||void 0===w?void 0:w.other)&&O.append("otherSymptoms",null===w||void 0===w?void 0:w.other),o&&O.append("captchaValue",o),e.next=22,B.post("saveCompensarInfo",O,{headers:{"Content-Type":"multipart/form-data; boundary=saveCompensarInfo"}});case 22:A=e.sent,i({}),s&&(null===(d=A.data)||void 0===d?void 0:d.submissionId)&&(u(!1),c.push(s,{submissionId:null===(k=A.data)||void 0===k?void 0:k.submissionId})),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(1),console.log(e.t0),a("beforeSubmit:submitError");case 31:case"end":return e.stop()}}),e,null,[[1,27]])})))).apply(this,arguments)}function R(e){if(!(null===e||void 0===e?void 0:e.selected))return!1;for(var t=e.selected,a=["breathShortness","feverChillsSweating","dryCough","wetCough","newOrWorseCough"],n=!1,r=0;!n&&r<(null===t||void 0===t?void 0:t.length);r++)n=a.includes(t[r]);return n}var V=a(247),W=S.object({symptomsStartedDate:S.string().when("currentSymptoms",{is:function(e){return R(e)},then:function(e){return e.required()},otherwise:function(e){return e}})}).defined();t.default=c.a.memo((function(e){var t=e.previousStep,a=e.nextStep,n=e.storeKey,d=e.metadata,v=p()({bindTo:document&&document.getElementById("wizard-buttons")}).Portal,S=Object(D.a)(),j=S.setDoGoBack,A=S.setTitle,k=S.setType,x=Object(l.g)(),T=Object(m.a)().t,z=Object(h.d)(Object(E.b)(n)),B=z.state,F=z.action,M=c.a.useState(!0),U=Object(s.a)(M,2),J=U[0],P=U[1],Y=Object(b.e)({mode:"onChange",defaultValues:null===B||void 0===B?void 0:B[n],resolver:Object(g.a)(W)}),N=Y.control,H=Y.handleSubmit,Q=Y.formState,Z=Y.watch,G=Q.errors,K=Q.isValid,X=Z("currentSymptoms"),_=c.a.useState(null),$=Object(s.a)(_,2),ee=$[0],te=$[1],ae=c.a.useState(null),ne=Object(s.a)(ae,2),re=ne[0],oe=ne[1],ie=c.a.useState(!0),se=Object(s.a)(ie,2),ue=se[0],ce=se[1],le=c.a.useState(!0),de=Object(s.a)(le,2),pe=de[0],me=de[1],ve=Q.isSubmitting;Object(u.useEffect)((function(){re||te(null)}),[re]);var fe=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,L({setSubmitError:function(e){return te(e?T(e):null)},state:Object(o.a)(Object(o.a)({},B),{},{"submit-steps":Object(o.a)(Object(o.a)({},B["submit-steps"]),t)}),captchaValue:re,action:F,nextStep:a,setActiveStep:P,history:x});case 3:f.a.dataLayer({dataLayer:{event:"successful_session"}});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),be=c.a.useCallback((function(){P(!1),t?x.push(t):x.goBack()}),[x,t]);Object(u.useEffect)((function(){Object(q.a)(),A(T("questionary:headerQuestions")),k("primary"),j((function(){return be}))}),[be,j,A,k,T]);var he=c.a.useMemo((function(){return R(X)}),[X]);return Object(u.useEffect)((function(){var e=function(){var e="iframeRecaptcha";if(null===document.getElementById(e)){var t=document.createElement("script");t.setAttribute("src","https://www.google.com/recaptcha/api2/bframe?hl=es&v=O4xzMiFqEvA4YhWjk5t8Xuas&k=".concat("6LcRhdIZAAAAAOI8zafkWF0N5SYOUjMszuEUnrJT")),t.setAttribute("id",e),document.body.appendChild(t),t.onload=function(){me(!1)}}else me(!1)};return"complete"===document.readyState?e():(window.addEventListener("load",e,!1),function(){window.removeEventListener("load",e)})}),[]),c.a.createElement(V.MainContainer,null,c.a.createElement(C.a,{currentStep:null===d||void 0===d?void 0:d.current,totalSteps:null===d||void 0===d?void 0:d.total,progressBar:!0}),he&&c.a.createElement(c.a.Fragment,null,c.a.createElement(V.QuestionText,{extraSpace:!0,first:!0},T("questionary:symptomsDate")),c.a.createElement(b.a,{control:N,name:"symptomsStartedDate",defaultValue:"",render:function(e){var t=e.onChange,a=e.value;return c.a.createElement(O.a,{singleSelection:!0,value:{selected:a?[a]:[]},onChange:function(e){return t(e.selected[0])},items:[{value:"today",label:T("questionary:options.today")},{value:"days",label:T("questionary:options.days")},{value:"week",label:T("questionary:options.week")},{value:"overWeek",label:T("questionary:options.overWeek")}]})}})),c.a.createElement("p",null,c.a.createElement(y.a,{errors:G,name:"name"})),J&&c.a.createElement(v,null,pe&&c.a.createElement("div",{className:"text-center"},"Cargando, por favor espere..."),c.a.createElement(I,{onChange:oe,setRecaptchaAvailable:ce}),ee&&c.a.createElement(V.TempBeforeSubmitError,null,ee),c.a.createElement(w.a,{invert:!0,leftLabel:T(ve?"questionary:submitting":"beforeSubmit:submitButton"),leftDisabled:ve||ue&&!re||!K,leftHandler:H(fe)})))}))},305:function(e,t,a){"use strict";a.r(t);var n=a(288);a.d(t,"default",(function(){return n.default}))}}]);
//# sourceMappingURL=27.314dbee7.chunk.js.map