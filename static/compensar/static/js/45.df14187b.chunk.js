(this["webpackJsonpcompensar-app"]=this["webpackJsonpcompensar-app"]||[]).push([[45],{283:function(e,t,a){"use strict";a.r(t);var n=a(208),r=a.n(n),o=a(207),i=a(209),s=a(196),u=a(9),c=a.n(u),l=a(214),d=a(206),p=a.n(d),m=a(807),v=a(217),b=a(199),f=a(232),h=a(236),g=a(233),y=a(203),S=a(204),C=a(323),j=a(322),O=a(433),w=a(17),E=a(195);function k(){var e=Object(E.a)(["\n  margin: 20px 0;\n  \n  div {\n    margin: auto;\n  }\n"]);return k=function(){return e},e}var T=a(194).default.div(k()),x=function(e){var t=e.onChange,a=e.setRecaptchaAvailable,n=Object(m.a)().i18n;return c.a.createElement(T,null,c.a.createElement(O.a,{sitekey:"6LcRhdIZAAAAAOI8zafkWF0N5SYOUjMszuEUnrJT",onChange:t,onErrored:function(){a(!1),w.a("Error on ReCAPTCHA")},hl:n.language,size:"compact"}))},A=a(200),D=a(201),I=a(417),q=a.n(I).a.create({baseURL:"https://lwdzsrlhnk.execute-api.us-east-2.amazonaws.com/prod"});function B(e){return z.apply(this,arguments)}function z(){return(z=Object(i.a)(r.a.mark((function e(t){var a,n,o,i,s,u,c,l,d,p,m,v,b,f,h,g,y,S,C,j,O,w,E,k,T;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.setSubmitError,n=t.state,o=t.captchaValue,i=t.action,s=t.nextStep,u=t.setActiveStep,c=t.history,e.prev=1,a(null),p=n.welcome,m=p.patientId,v=p.agreedConsentTerms,b=p.agreedPolicyTerms,f=p.agreedCovidDetection,h=p.agreedCovidCollection,g=p.agreedTrainingArtificial,y=p.agreedBiometric,S=n["submit-steps"],C=S.recordYourCough,j=S.currentSymptoms,O=S.symptomsStartedDate,w=new FormData,m&&w.append("patientId",m),window.sourceCampaign&&w.append("source",window.sourceCampaign),w.append("agreedConsentTerms",v),w.append("agreedPolicyTerms",b),w.append("agreedCovidCollection",h),w.append("agreedCovidDetection",f),w.append("agreedTrainingArtificial",g),w.append("agreedBiometric",y),E=C.recordingFile||C.uploadedFile,w.append("cough",E,E.name||"filename.wav"),(null===j||void 0===j||null===(l=j.selected)||void 0===l?void 0:l.length)>0&&w.append("currentSymptoms",j.selected.join(",")),O&&w.append("symptomsStartedDate",O),(null===j||void 0===j?void 0:j.other)&&w.append("otherSymptoms",null===j||void 0===j?void 0:j.other),o&&w.append("captchaValue",o),e.next=22,q.post("saveCompensarInfo",w,{headers:{"Content-Type":"multipart/form-data; boundary=saveCompensarInfo"}});case 22:k=e.sent,i({}),s&&(null===(d=k.data)||void 0===d?void 0:d.submissionId)&&(u(!1),c.push(s,{submissionId:null===(T=k.data)||void 0===T?void 0:T.submissionId})),e.next=31;break;case 27:e.prev=27,e.t0=e.catch(1),console.log(e.t0),a("beforeSubmit:submitError");case 31:case"end":return e.stop()}}),e,null,[[1,27]])})))).apply(this,arguments)}function V(e){if(!(null===e||void 0===e?void 0:e.selected))return!1;for(var t=e.selected,a=["breathShortness","feverChillsSweating","dryCough","wetCough","newOrWorseCough"],n=!1,r=0;!n&&r<(null===t||void 0===t?void 0:t.length);r++)n=a.includes(t[r]);return n}var F=a(243),R=g.object({symptomsStartedDate:g.string().when("currentSymptoms",{is:function(e){return V(e)},then:function(e){return e.required()},otherwise:function(e){return e}})}).defined();t.default=c.a.memo((function(e){var t=e.previousStep,a=e.nextStep,n=e.storeKey,d=e.metadata,g=p()({bindTo:document&&document.getElementById("wizard-buttons")}).Portal,O=Object(A.a)(),w=O.setDoGoBack,E=O.setTitle,k=O.setType,T=Object(l.g)(),I=Object(m.a)().t,q=Object(b.d)(Object(y.b)(n)),z=q.state,P=q.action,W=c.a.useState(!0),J=Object(s.a)(W,2),L=J[0],M=J[1],U=Object(v.e)({mode:"onChange",defaultValues:null===z||void 0===z?void 0:z[n],resolver:Object(f.a)(R)}),H=U.control,Q=U.handleSubmit,Y=U.formState,G=U.watch,K=Y.errors,N=Y.isValid,Z=G("currentSymptoms"),X=c.a.useState(null),$=Object(s.a)(X,2),_=$[0],ee=$[1],te=c.a.useState(null),ae=Object(s.a)(te,2),ne=ae[0],re=ae[1],oe=c.a.useState(!0),ie=Object(s.a)(oe,2),se=ie[0],ue=ie[1],ce=Y.isSubmitting;Object(u.useEffect)((function(){ne||ee(null)}),[ne]);var le=function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return e.next=3,B({setSubmitError:function(e){return ee(e?I(e):null)},state:Object(o.a)(Object(o.a)({},z),{},{"submit-steps":Object(o.a)(Object(o.a)({},z["submit-steps"]),t)}),captchaValue:ne,action:P,nextStep:a,setActiveStep:M,history:T});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=c.a.useCallback((function(){M(!1),t?T.push(t):T.goBack()}),[T,t]);Object(u.useEffect)((function(){Object(D.a)(),E(I("questionary:headerQuestions")),k("primary"),w((function(){return de}))}),[de,w,E,k,I]);var pe=c.a.useMemo((function(){return V(Z)}),[Z]);return c.a.createElement(F.MainContainer,null,c.a.createElement(C.a,{currentStep:null===d||void 0===d?void 0:d.current,totalSteps:null===d||void 0===d?void 0:d.total,progressBar:!0}),pe&&c.a.createElement(c.a.Fragment,null,c.a.createElement(F.QuestionText,{extraSpace:!0,first:!0},I("questionary:symptomsDate")),c.a.createElement(v.a,{control:H,name:"symptomsStartedDate",defaultValue:"",render:function(e){var t=e.onChange,a=e.value;return c.a.createElement(j.a,{singleSelection:!0,value:{selected:a?[a]:[]},onChange:function(e){return t(e.selected[0])},items:[{value:"today",label:I("questionary:options.today")},{value:"days",label:I("questionary:options.days")},{value:"week",label:I("questionary:options.week")},{value:"overWeek",label:I("questionary:options.overWeek")}]})}})),c.a.createElement("p",null,c.a.createElement(h.a,{errors:K,name:"name"})),L&&c.a.createElement(g,null,c.a.createElement(x,{onChange:re,setRecaptchaAvailable:ue}),_&&c.a.createElement(F.TempBeforeSubmitError,null,_),c.a.createElement(S.a,{invert:!0,leftLabel:I(ce?"questionary:submitting":"beforeSubmit:submitButton"),leftDisabled:ce||se&&!ne||!N,leftHandler:Q(le)})))}))}}]);
//# sourceMappingURL=45.df14187b.chunk.js.map