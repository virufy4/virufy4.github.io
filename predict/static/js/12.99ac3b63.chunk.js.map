{"version":3,"sources":["hooks/useHeaderContext.ts","helper/scrollHelper.ts","utils/wizard.ts","components/Button/style.ts","components/Button/Button.tsx","modals/ConfirmationModal/style.ts","modals/ConfirmationModal/ConfirmationModal.tsx","containers/SubmitSteps/Submission/PredictionResult/PredictionResult.tsx","hooks/useModals.ts","containers/SubmitSteps/Submission/PredictionResult/index.ts"],"names":["useHeaderContext","React","useContext","HeaderContext","title","setTitle","subtitle","setSubtitle","type","setType","logoSize","setLogoSize","setDoGoBack","doGoBack","scrollToTop","window","scrollTo","top","behavior","updateAction","storeKey","state","payload","resetStore","welcome","language","StyledButton","styled","button","dark","color","disabled","colors","purple_50","purple","white","Button","memo","children","props","ModalBody","div","theme","breakpoints","tablet","ModalTitle","ModalContent","Modal","setAppElement","ConfirmationModal","isOpen","modalTitle","toggle","onConfirm","handleOnConfirm","useCallback","onRequestClose","style","content","minHeight","maxWidth","margin","bottom","right","left","backgroundColor","borderRadius","border","overlay","className","onClick","PredictionResult","t","useTranslation","useStateMachine","actions","useState","errorCode","setErrorCode","processing","setProcessing","prediction","setPrediction","submitError","setSubmitError","setIsOpen","openModal","closeModal","toggleModal","s","useModal","useEffect","target","document","getElementById","display","handleSubmit","a","recordYourCough","body","FormData","coughFile","recordingFile","uploadedFile","append","name","passcode","axios","post","process","headers","predictionResult","data","console","log","renderResult","useMemo","red","Trans","i18nKey","green","black"],"mappings":"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","file":"static/js/12.99ac3b63.chunk.js","sourcesContent":["import React from 'react';\nimport { HeaderContext } from 'components/Header';\n\nconst useHeaderContext = () => {\n  const {\n    title, setTitle, subtitle, setSubtitle, type, setType, logoSize, setLogoSize, setDoGoBack, doGoBack,\n  } = React.useContext(HeaderContext);\n\n  return {\n    title,\n    setTitle,\n    subtitle,\n    setSubtitle,\n    type,\n    setType,\n    logoSize,\n    setLogoSize,\n    doGoBack,\n    setDoGoBack,\n  };\n};\n\nexport default useHeaderContext;\n","export const scrollToTop = function scrollToTop() {\n  window.scrollTo({ top: 0, behavior: 'smooth' });\n};\n\nexport const scrollToBottom = function scrollToBottom() {\n  window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });\n};\n","// TODO: Improve types\nexport function updateAction(storeKey: string): any {\n  return (state: any, payload: any) => ({\n    ...state,\n    [storeKey]: {\n      ...state[storeKey],\n      ...payload,\n    },\n  });\n}\n\nexport function resetStore(): any {\n  return (state: any) => ({ welcome: { language: state.welcome.language } });\n}\n","import styled from 'styled-components';\nimport { colors } from '../../theme';\n\nexport interface StyledButtonProps {\n  disabled?: boolean;\n  dark?: boolean;\n  id?: string;\n}\n\nexport const StyledButton = styled.button<StyledButtonProps>`\n  height: 52px;\n  border-radius: 15px; \n  font-family: 'Source Sans Pro'; /* It could be removed if default on body changes */\n  font-weight: bold;\n  font-size: 14px;\n  font-weight: bold;\n  width: 100%;\n\n  ${({ dark, disabled }) => {\n    const color = disabled ? colors.purple_50 : colors.purple;\n    return dark ? `\n    background-color: ${color};\n    color: ${colors.white};\n    border: none;\n  ` : `\n    background-color: ${colors.white};\n    color: ${color};\n    border: 1px solid ${color};\n  `;\n  }}\n`;\n","import React, { PropsWithChildren } from 'react';\n\n// Styles\nimport {\n  StyledButton,\n  StyledButtonProps,\n} from './style';\n\nexport interface ButtonProps extends PropsWithChildren<StyledButtonProps> {\n  onClick?: ((event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void);\n}\n\nconst Button = React.memo(({ children, ...props }: ButtonProps) => ((\n  <StyledButton\n    type=\"button\"\n    {...props}\n  >\n    {children}\n  </StyledButton>\n)));\n\nexport default Button;\n","import styled from 'styled-components';\n\nexport const ModalBody = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: space-around;\n\n  @media screen and (${props => props.theme.breakpoints.tablet}) {\n    height: 100%;\n    max-width: 400px;\n    margin: auto;\n`;\n\nexport const ModalTitle = styled.div`\n  font-size: 18px;\n  font-weight: 600;\n  margin-bottom: 17px;\n`;\n\nexport const ModalContent = styled.div`\n  font-size: 14px;\n  margin-bottom: 17px;\n`;\n","/* eslint-disable react/jsx-props-no-spreading */\nimport React, { PropsWithChildren } from 'react';\nimport Modal from 'react-modal';\n\n// Components\nimport Button from 'components/Button';\n\n// Styles\n\nimport {\n  ModalBody, ModalTitle, ModalContent,\n} from './style';\n\nexport interface ConfirmationModalProps {\n  isOpen: boolean;\n  modalTitle: string;\n  toggle: () => void;\n  onConfirm?: () => void;\n}\n\nModal.setAppElement('#root');\n\nconst ConfirmationModal = React.memo(({\n  isOpen,\n  modalTitle,\n  children,\n  toggle,\n  onConfirm,\n  ...props\n}: PropsWithChildren<ConfirmationModalProps>) => {\n  // Handlers\n\n  const handleOnConfirm = React.useCallback(() => {\n    onConfirm?.();\n    toggle();\n  }, [onConfirm, toggle]);\n\n  const customStyles = {\n    content: {\n      minHeight: '328px',\n      maxWidth: '768px',\n      margin: 'auto',\n      top: '60%',\n      bottom: '0px',\n      right: '0px',\n      left: '0px',\n      backgroundColor: '#EBF1FC',\n      borderRadius: '70px 70px 0px 0px',\n      border: 'none',\n    },\n    overlay: { backgroundColor: 'rgba(0, 0, 0, 0.3)' },\n  };\n\n  return (\n    <Modal\n      {...props}\n      isOpen={isOpen}\n      onRequestClose={toggle}\n      style={customStyles}\n    >\n      <ModalBody className=\"ModalBody\">\n        <ModalTitle>{modalTitle}</ModalTitle>\n        <ModalContent>{children}</ModalContent>\n        <Button onClick={handleOnConfirm} dark>\n          OK\n        </Button>\n      </ModalBody>\n    </Modal>\n  );\n});\n\nexport default ConfirmationModal;\n","import React from 'react';\nimport { useTranslation, Trans } from 'react-i18next';\nimport axios from 'axios';\n\n// Form\nimport { useStateMachine } from 'little-state-machine';\n\n// Hooks\nimport { useModal } from 'hooks/useModals';\n\n// Modals\nimport ConfirmationModal from 'modals/ConfirmationModal';\n\n// Update Action\nimport { resetStore } from 'utils/wizard';\n\n// Header Control\nimport useHeaderContext from 'hooks/useHeaderContext';\n\n// Utils\nimport { scrollToTop } from 'helper/scrollHelper';\n\n// Styles\nimport { colors } from '../../../../theme';\nimport {\n  Title,\n  ImageProcessing,\n  ProcessingContainer,\n  PredictionResultContainer,\n  TitleResult,\n  ImagePredictionResult,\n  VLogo,\n  SubmitError,\n  IntroText,\n} from './style';\n\nconst predictionEndpointUrl = process.env.REACT_APP_PREDICTION_ENDPOINT || '';\n\nconst PredictionResult = () => {\n  // Hooks\n  const {\n    setDoGoBack, setTitle, setSubtitle, setType,\n  } = useHeaderContext();\n  const { t } = useTranslation();\n  const { state, actions } = useStateMachine({ resetStore: resetStore() });\n\n  // States\n  const [errorCode, setErrorCode] = React.useState<string | null>(null);\n  const [processing, setProcessing] = React.useState<boolean>(true);\n  const [prediction, setPrediction] = React.useState<string>('unknown');\n  const [submitError, setSubmitError] = React.useState<string | null>(null);\n\n  const { isOpen, openModal, closeModal } = useModal();\n\n  React.useEffect(() => {\n    // Hide the Footer Report Problems while processing\n    const target = document && document.getElementById('footer-report-problems');\n    if (target) {\n      if (processing) {\n        target.style.display = 'none';\n      } else {\n        target.style.display = 'flex';\n      }\n    }\n  }, [processing]);\n\n  // Handlers\n  const handleSubmit = async () => {\n    try {\n      setSubmitError(null);\n      if (state && state.welcome && state['submit-steps']) {\n        const {\n          recordYourCough,\n        } = state['submit-steps'];\n\n        const body = new FormData();\n\n        // Records\n        const coughFile = recordYourCough?.recordingFile || recordYourCough?.uploadedFile;\n        if (coughFile) {\n          body.append('cough', coughFile, coughFile.name || 'filename.wav');\n        }\n\n        body.append('passcode', state.welcome?.passcode ?? '');\n\n        body.append('patientId', 'predict-app');\n\n        const predictionResult = await axios.post(predictionEndpointUrl, body, {\n          headers: {\n            'Content-Type': 'multipart/form-data',\n          },\n        });\n        if (predictionResult.data) {\n          setProcessing(false);\n          setPrediction(predictionResult.data.prediction);\n          setErrorCode(predictionResult.data.errorCode);\n          actions.resetStore({});\n        }\n      } else {\n        actions.resetStore({});\n      }\n    } catch (err) {\n      console.log('Error', err);\n      setSubmitError(t('predictionResult:submitError'));\n    }\n  };\n\n  // Effects\n  React.useEffect(() => {\n    scrollToTop();\n    setTitle('');\n    setDoGoBack(() => {});\n    handleSubmit();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  React.useEffect(() => {\n    if (processing) {\n      setSubtitle('');\n      setType('noShape');\n    } else {\n      setSubtitle(`${t('predictionResult:result')}`);\n      setType('shapeUp');\n      openModal();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [processing]);\n\n  const renderResult = React.useMemo(() => {\n    if (prediction === 'positive') {\n      return (\n        <>\n          <TitleResult color={colors.red}>\n            {t('predictionResult:resultDetected')}\n          </TitleResult>\n          <IntroText>\n            <Trans i18nKey=\"predictionResult:resultDetectedTextt\">\n              Your voice has indicators of COVID-19.\n              <strong>Please contact your healthcare professional</strong> and take additional precautions.\n            </Trans>\n          </IntroText>\n          <ImagePredictionResult />\n        </>\n      );\n    }\n    if (prediction === 'negative') {\n      return (\n        <>\n          <TitleResult color={colors.green}>\n            {t('predictionResult:resultNotDetected')}\n          </TitleResult>\n          <IntroText>\n            <Trans i18nKey=\"predictionResult:resultNotDetectedText\">\n              Your voice does not seem to have indicators of COVID-19. Please\n              <strong>continue to take appropriate measures</strong>\n              based on the advice of your healthcare professional or applicable\n              regulatory body and reassess yourself in our app daily.\n            </Trans>\n          </IntroText>\n          <VLogo />\n        </>\n      );\n    }\n    return (\n      <>\n        <TitleResult color={colors.black}>\n          {t('predictionResult:resultNotAnalyze')}\n        </TitleResult>\n        <IntroText>\n          <Trans i18nKey=\"predictionResult:resultNotAnalyzeText\">\n            Our algorithm is not able to determine your COVID-19 status. <strong>Please submit another cough.</strong>\n          </Trans>\n        </IntroText>\n        <ImagePredictionResult />\n      </>\n    );\n  }, [prediction, t]);\n\n  return (\n    <>\n      {\n        processing ? (\n          <ProcessingContainer>\n            {/* Title */}\n            <Title>\n              {t('predictionResult:processingTitle')}\n            </Title>\n\n            {/* Image */}\n            <ImageProcessing />\n          </ProcessingContainer>\n        ) : (\n          <>\n            <ConfirmationModal\n              isOpen={isOpen}\n              modalTitle={t('predictionResult:note')}\n              toggle={closeModal}\n              onConfirm={closeModal}\n            >\n              <Trans i18nKey=\"predictionResult:resultModal\">\n                This app will not predict your COVID-19 status or diagnose any disease, disorder,\n                or other health condition. Virufy is conducting research and will use the information\n                you provide for that research only. Virufy will not take place of a doctor and would like to\n                remind you it is your responsiblity to seek medical advice from your doctor.\n              </Trans>\n            </ConfirmationModal>\n            <PredictionResultContainer>\n              {renderResult}\n            </PredictionResultContainer>\n          </>\n        )\n      }\n      {(errorCode || submitError) && (\n      <SubmitError>\n        {errorCode ? `${t('predictionResult:error')} ${errorCode}` : submitError}\n      </SubmitError>\n      )}\n    </>\n  );\n};\n\nexport default React.memo(PredictionResult);\n","import React from 'react';\n\nexport function useModal() {\n  // State\n  const [isOpen, setIsOpen] = React.useState<boolean>(false);\n\n  // Handlers\n  const openModal = React.useCallback(() => {\n    setIsOpen(true);\n  }, []);\n\n  const closeModal = React.useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  const toggleModal = React.useCallback(() => {\n    setIsOpen(s => !s);\n  }, []);\n\n  const out = {\n    isOpen,\n    openModal,\n    closeModal,\n    toggleModal,\n  };\n\n  return out;\n}\n","export { default } from './PredictionResult';\n"],"sourceRoot":""}